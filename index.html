<!DOCTYPE html>
<html lang="en">
<head>
  ....
  <meta charset="UTF-8">
  <title>Title</title>
  <link rel="stylesheet" href="./css/index.css">
</head>
<body>
  <div id="wrap">
    <!--头部-->
    <header id="header">
      <section class="headerMain">
        <!--logo-->
        <h1 class="logo">
          <a href="javascript:">
            <img src="./img/logo.png" alt="logo">
          </a>
        </h1>
        <!--music-->
        <div class="music">
          <audio src="./img/audio.mp3" autoplay loop></audio>
        </div>
        <!--导航-->
        <ul class="list">
          <li>
            <a href="javascript:">
              <div class="up"><img src="./img/home_gruen.png" alt="home"></div>
              <div class="down"><img src="./img/home.png" alt="home"></div>
            </a>
          </li>
          <li>
            <a href="javascript:">
              <div class="up">Course</div>
              <div class="down">Course</div>
            </a>
          </li>
          <li>
            <a href="javascript:">
              <div class="up">Works</div>
              <div class="down">Works</div>
            </a>
          </li>
          <li>
            <a href="javascript:">
              <div class="up">About</div>
              <div class="down">About</div>
            </a>
          </li>
          <li>
            <a href="javascript:">
              <div class="up">Team</div>
              <div class="down">Team</div>
            </a>
          </li>
        </ul>
        <!--小箭头-->
        <div class="arrow"></div>
      </section>
    </header>
    <!--内容区-->
    <section id="content">
      <ul class="contentMain">
        <li>
          <section class="home">
            <!--轮播图容器-->
            <ul class="home_list">
              <li class="active"><div class="commonTitle">one layer</div></li>
              <li><div class="commonTitle">two layer</div></li>
              <li><div class="commonTitle">three layer</div></li>
              <li><div class="commonTitle">four layer</div></li>
            </ul>
            <!--小圆点-->
            <ul class="home_points">
              <li class="active"></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </section>
        </li>
        <li>
          <section class="course">
            <h2 class="course_title commonTitle">
              <span>EINIGE</span><br/>
              <span>UNSERER</span><br/>
              <span>KUNDEN</span>
            </h2>
            <p class="course_content commonText">
              Das Kundenvertrauen in unsere Kompetenz ist die notwendige Basis einer erfolgreichen Zusammenarbeit, gleichzeitig aber auch das größte Lob, das man uns entgegenbringen kann.
              <br>
              Diese und viele weitere große und kleine Kunden vertrauen uns seit Jahren, was uns stolz macht, und dafür sagen wir an dieser Stelle einfach mal.
            </p>
            <div class="course_photo">
              <div class="line"></div>
              <div class="line"></div>
              <div class="line"></div>
              <div class="line"></div>
              <div class="line"></div>
              <ul class="course_list clearfix">
                <li>
                  <div class="front"></div>
                  <div class="back">我有一头晓飞张，从来也不骑</div>
                </li>
                <li>
                  <div class="front"></div>
                  <div class="back">我有一头晓飞张，从来也不骑</div>
                </li>
                <li>
                  <div class="front"></div>
                  <div class="back">我有一头晓飞张，从来也不骑</div>
                </li>
                <li>
                  <div class="front"></div>
                  <div class="back">我有一头晓飞张，从来也不骑</div>
                </li>
                <li>
                  <div class="front"></div>
                  <div class="back">我有一头晓飞张，从来也不骑</div>
                </li>
                <li>
                  <div class="front"></div>
                  <div class="back">我有一头晓飞张，从来也不骑</div>
                </li>
                <li>
                  <div class="front"></div>
                  <div class="back">我有一头晓飞张，从来也不骑</div>
                </li>
                <li>
                  <div class="front"></div>
                  <div class="back">我有一头晓飞张，从来也不骑</div>
                </li>
                <li>
                  <div class="front"></div>
                  <div class="back">我有一头晓飞张，从来也不骑</div>
                </li>
                <li>
                  <div class="front"></div>
                  <div class="back">我有一头晓飞张，从来也不骑</div>
                </li>
                <li>
                  <div class="front"></div>
                  <div class="back">我有一头晓飞张，从来也不骑</div>
                </li>
                <li>
                  <div class="front"></div>
                  <div class="back">我有一头晓飞张，从来也不骑</div>
                </li>
              </ul>
            </div>
            <div class="plane1"></div>
            <div class="plane2"></div>
            <div class="plane3"></div>
          </section>
        </li>
        <li>
          <section class="works">
            <h2 class="works_title commonTitle">
              <span>EINBLICK</span><br/>
              <span>ERKENNTNIS</span><br/>
              <span>ERGEBNIS</span>
            </h2>
            <ul class="works_list clearfix">
              <li>
                <img src="./img/worksimg1.jpg" alt="worksimg1">
                <div class="mask">
                  <span>我有一头晓飞张</span>
                  <div class="icon"></div>
                </div>
              </li>
              <li>
                <img src="./img/worksimg2.jpg" alt="worksimg1">
                <div class="mask">
                  <span>我从来也不骑</span>
                  <div class="icon"></div>
                </div>
              </li>
              <li>
                <img src="./img/worksimg3.jpg" alt="worksimg1">
                <div class="mask">
                  <span>有一天心血来潮</span>
                  <div class="icon"></div>
                </div>
              </li>
              <li>
                <img src="./img/worksimg4.jpg" alt="worksimg1">
                <div class="mask">
                  <span>骑ta去赶集</span>
                  <div class="icon"></div>
                </div>
              </li>
            </ul>
            <div class="works_robot"></div>
            <div class="pencel1"></div>
            <div class="pencel2"></div>
            <div class="pencel3"></div>
          </section>
        </li>
        <li>
          <section class="about">
            <h2 class="about_title commonTitle">
              <span>DIE</span><br/>
              <span>SPEZIELLE</span><br/>
              <span>VIELFALT</span>
            </h2>
            <p class="about_content commonText">
              Der bunte Medienmix ist die Faszination die uns antreibt und das, was man an uns schätzt. Von A bis Z und von vorne bis hinten nehmen wir Ihr Projekt unter unsere Fittiche und lassen es zu etwas Großartigem heranwachsen.
            </p>
            <ul class="about_list">
              <li>
                <img src="./img/about2.jpg" alt="about2">
                <ul>
                  <li><div></div></li>
                  <li><div></div></li>
                  <li><div></div></li>
                  <li><div></div></li>
                </ul>
              </li>
              <li>
                <img src="./img/about4.jpg" alt="about2">
                <ul>
                  <li><div></div></li>
                  <li><div></div></li>
                  <li><div></div></li>
                  <li><div></div></li>
                </ul>
              </li>
            </ul>
            <div class="about_line"></div>
          </section>
        </li>
        <li>
          <section class="team">
            <h2 class="team_title commonTitle">
              <span>WIR SIND</span><br/>
              <span>VOXELAIR</span>
            </h2>
            <p class="team_content commonText">
              Wir sind seit 2002 eine Full-Service-Werbeagentur mit Stammsitz in Heimsheim, zwischen Stuttgart und Karlsruhe.    
              <br>
              Über 60 Jahre Erfahrung vereinen das gesamte VoxelAir-Team. Dabei hat jedes Voxel neben professionellem Allroundwissen auch sein ganz spezielles Gebiet, um selbst die individuellsten Kundenwünsche schnell und kompetent umzusetzen.
            </p>
            <ul class="team_person">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </section>
        </li>
      </ul>
      <!--侧边导航区域-->
      <ul class="menuBar">
        <li class="active"></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
      </ul>
    </section>
    <!--开机动画遮罩层-->
    <section id="mask">
      <div class="mask_top"></div>
      <div class="mask_bottom"></div>
      <div class="mask_line"></div>
    </section>
  </div>
  <script type="text/javascript">

    if (window.addEventListener) {
      //等待dom被加载/创建完成的事件
      window.addEventListener('DOMContentLoaded', main);
    } else {
      window.onload = main;
    }

    function main() {
      //获取DOM元素
      //头部dom
      var liNodes = document.querySelectorAll('#header .headerMain .list li');
      var upNodes = document.querySelectorAll('#header .headerMain .list li .up');
      var arrowNode = document.querySelector('#header .headerMain .arrow');
      var musicNode = document.querySelector('#header .headerMain .music');
      var audioNode = document.querySelector('#header .headerMain .music>audio');
      //内容区dom
      var contentNode = document.querySelector('#content');
      var ulNode = document.querySelector('#content .contentMain');
      var menuBarPoints = document.querySelectorAll('#content .menuBar>li');
      //第一屏dom
      var homeLiNodes = document.querySelectorAll('#content .contentMain .home .home_list>li');
      var homePointsNodes = document.querySelectorAll('#content .contentMain .home .home_points>li');
      var homeUlNode = document.querySelector('#content .contentMain .home .home_list');
      var homePointsUlNode = document.querySelector('#content .contentMain .home .home_points');
      //第二屏dom
      var plant1Node = document.querySelector('#content .contentMain .course .plane1');
      var plant2Node = document.querySelector('#content .contentMain .course .plane2');
      var plant3Node = document.querySelector('#content .contentMain .course .plane3');
      //第三屏dom
      var pencel1Node = document.querySelector('#content .contentMain .works .pencel1');
      var pencel2Node = document.querySelector('#content .contentMain .works .pencel2');
      var pencel3Node = document.querySelector('#content .contentMain .works .pencel3');
      //第四屏dom
      var aboutLiNodes = document.querySelectorAll('#content .contentMain .about .about_list>li');
      //第五屏dom
      var teamUlNode = document.querySelector('#content .contentMain .team .team_person');
      var teamLiNodes = document.querySelectorAll('#content .contentMain .team .team_person>li');
      var teamTitleNode = document.querySelector('#content .contentMain .team .team_title');
      var teamContentNode = document.querySelector('#content .contentMain .team .team_content');

      //初始化下标0
      var nowIndex = 0;
      var lastIndex = 0;
      //滚轮节流函数的timer
      var wheelTimer = null;

      //出入场动画
      var animationArr = [
        {
          //第一屏出入场动画
          anIn: function () {
            //入场动画
            homeUlNode.style.transform = 'translateY(0)';
            homePointsUlNode.style.transform = 'translate(-50%, 0)';
            homeUlNode.style.opacity = 1;
            homePointsUlNode.style.opacity = 1;
          },
          anOut: function () {
            //出场动画
            homeUlNode.style.transform = 'translateY(-200px)';
            homePointsUlNode.style.transform = 'translate(-50%, 200px)';
            homeUlNode.style.opacity = 0;
            homePointsUlNode.style.opacity = 0;
          }
        },
        {
          //第二屏出入场动画
          anIn: function () {
            plant1Node.style.transform = 'translate(0px, 0px)';
            plant2Node.style.transform = 'translate(0px, 0px)';
            plant3Node.style.transform = 'translate(0px, 0px)';
          },
          anOut: function () {
            plant1Node.style.transform = 'translate(-200px, -200px)';
            plant2Node.style.transform = 'translate(-200px, 200px)';
            plant3Node.style.transform = 'translate(200px, -200px)';
          }
        },
        {
          //第三屏出入场动画
          anIn: function () {
            pencel1Node.style.transform = 'translateY(0px)';
            pencel2Node.style.transform = 'translateY(0px)';
            pencel3Node.style.transform = 'translateY(0px)';
          },
          anOut: function () {
            pencel1Node.style.transform = 'translateY(-200px)';
            pencel2Node.style.transform = 'translateY(200px)';
            pencel3Node.style.transform = 'translateY(200px)';
          }
        },
        {
          //第四屏出入场动画
          anIn: function () {
            aboutLiNodes[0].style.transform = 'rotate(0deg)';
            aboutLiNodes[1].style.transform = 'rotate(0deg)';
          },
          anOut: function () {
            aboutLiNodes[0].style.transform = 'rotate(45deg)';
            aboutLiNodes[1].style.transform = 'rotate(-45deg)';
          }
        },
        {
          //第五屏出入场动画
          anIn: function () {
            teamTitleNode.style.transform = 'translateX(0px)';
            teamContentNode.style.transform = 'translateX(0px)';
          },
          anOut: function () {
            teamTitleNode.style.transform = 'translateX(-200px)';
            teamContentNode.style.transform = 'translateX(200px)';
          }
        }
      ];

      //初始化加载，所有屏都得做出场动画
      for (var i = 0; i < animationArr.length; i++) {
        animationArr[i]['anOut']();
      }

      //开机动画
      bootAnimation();
      function bootAnimation() {
        //开机动画遮罩层
        var maskLineNode = document.querySelector('#mask .mask_line');
        var maskTopNode = document.querySelector('#mask .mask_top');
        var maskBottomNode = document.querySelector('#mask .mask_bottom');
        var maskNode = document.querySelector('#mask');
        //等待图片加载完成，开机动画结束
        var arr = ['bg1.jpg','bg2.jpg','bg3.jpg','bg4.jpg','bg5.jpg','about1.jpg','about2.jpg','about3.jpg','about4.jpg','worksimg1.jpg','worksimg2.jpg','worksimg3.jpg','worksimg4.jpg','team.png','greenLine.png'];
        //初始化%为0
        var percent = 0;
          for (var i = 0; i < arr.length; i++) {
          var img = new Image();
          img.src = './img/' + arr[i];
          img.onload = function () {
            //每当一张图片加载完成，对应百分比加1
            percent++;
            //修改线的长度
            maskLineNode.style.width = percent / arr.length * 100 + '%';
          }
        }

        maskLineNode.addEventListener('transitionend', function () {
          maskTopNode.style.height = 0;
          maskBottomNode.style.height = 0;
          maskLineNode.style.display = 'none';
        })

        maskTopNode.addEventListener('transitionend', function () {
          animationArr[0].anIn();
          //开机动画只需一次，用完清除掉
          maskNode.remove();
        })

      }


      //音乐
      musicNode.onclick = function () {
        if (audioNode.paused) {
          //说明音乐是暂停的
          audioNode.play();
          this.style.backgroundImage = 'url("./img/musicon.gif")';
        } else {
          //说明音乐正在播放
          audioNode.pause();
          this.style.backgroundImage = 'url("./img/musicoff.gif")';
        }
      }

      //侧边导航
      //给每个li绑定点击事件
      for (var i = 0; i < menuBarPoints.length; i++) {
        menuBarPoints[i].index = i;
        menuBarPoints[i].onclick = function () {
          //将nowIndex改为li下标值
          nowIndex = this.index;
          //调用move
          move(nowIndex);
        }
      }


      //第五屏js代码
      teamHandle();
      function teamHandle() {
        var canvas = null;
        var paintTimer = null;
        var createCircleTimer = null;

        //给Li绑定鼠标移入事件
        for (var i = 0; i < teamLiNodes.length; i++) {
          teamLiNodes[i].onmouseenter = function () {
            //将所有li的透明度改为0.5
            for (var j = 0; j < teamLiNodes.length; j++) {
              teamLiNodes[j].style.opacity = '0.5';
            }
            //将当前li透明度改为1
            this.style.opacity = 1;
            //添加canvas
            addCanvas();
            //改变canvas的位置
            canvas.style.left = this.offsetLeft + 'px';
          }
        }

        //给ul绑定鼠标移出事件
        teamUlNode.onmouseleave = function () {
          //鼠标移出将所有li透明度改为1
          for (var i = 0; i < teamLiNodes.length; i++) {
            teamLiNodes[i].style.opacity = 1;
          }
          //移出canvas
          removeCanvas();
        }

        function addCanvas() {
          if (!canvas) {
            //创建canvas
            canvas = document.createElement('canvas');
            canvas.width = teamLiNodes[0].offsetWidth;
            canvas.height = teamLiNodes[0].offsetHeight;
            canvas.style.position = 'absolute';
            canvas.style.top = 0;
            //将canvas添加ul中
            teamUlNode.appendChild(canvas);
            //生成气泡
            bubble();
          }
        }

        function removeCanvas() {
          clearInterval(paintTimer);
          clearInterval(createCircleTimer);
          canvas.remove();
          canvas = null;
        }

        function bubble() {
          //圆数据的数组
          var circleArr = [];

          //处理canvas兼容性问题
          if (canvas.getContext) {
            //获取画笔
            var ctx = canvas.getContext('2d');

            //画圆
            paintTimer = setInterval(function () {
              //清除画布：把之前画的清除掉
              ctx.clearRect(0, 0, canvas.width, canvas.height);

              for (var i = 0; i < circleArr.length; i++) {
                //增加角度
                circleArr[i].deg += 5;
                //求出弧度
                var rad = circleArr[i].deg * Math.PI / 180;
                //计算得出小圆点运动坐标
                var nowLeft = Math.floor(circleArr[i].x  +  Math.sin(rad) * circleArr[i].s);
                var nowTop = Math.floor(circleArr[i].y  - rad * circleArr[i].s);
                //将超出范围的圆清除掉
                if (nowTop <= 0) {
                  circleArr.splice(i, 1);
                  continue;
                }
                //绘制的颜色
                ctx.fillStyle = 'rgba(' + circleArr[i].r + ', ' + circleArr[i].g + ', ' + circleArr[i].b + ', 1)';
                //开始一条路径
                ctx.beginPath();
                //画圆
                /*
                   ctx.arc(横坐标，纵坐标，半径，起始弧度，结束弧度，顺时针/逆时针)
                 */
                ctx.arc(nowLeft, nowTop, circleArr[i].c_r, 0, Math.PI * 2);
                //填充
                ctx.fill();
              }

            }, 1000 / 60)

            //生成随机圆
            createCircleTimer = setInterval(function () {
              //颜色随机
              var r = Math.floor(Math.random() * 255);
              var g = Math.floor(Math.random() * 255);
              var b = Math.floor(Math.random() * 255);
              //半径随机
              var c_r = Math.floor(Math.random() * 8 + 2);
              //起始位置随机
              var x = Math.floor(Math.random() * canvas.width);
              var y = canvas.height + c_r
              //缩放系数
              var s = Math.floor(Math.random() * 50 + 10)

              circleArr.push({
                r: r,
                g: g,
                b: b,
                x: x,
                y: y,
                c_r: c_r,
                deg: 0,
                s: s
              })
            }, 50)

          };
        }

      }

      //第一屏js代码
      homeHandle();
      function homeHandle() {

        //初始化上一次的下标
        var lastIndex = 0;
        //初始化当前点击元素的下标
        var nowIndex = 0;
        //初始化timer
        var timer = null;

        //给ul绑定鼠标移入移出事件
        homeUlNode.onmouseenter = function () {
          //清除定时器
          clearInterval(timer);
        }
        homeUlNode.onmouseleave = function () {
          //开启定时器
          autoPlay();
        }

        //给小圆点绑定点击事件
        for (var i = 0; i < homePointsNodes.length; i++) {
          homePointsNodes[i].index = i;
          homePointsNodes[i].onclick = function () {
            //改变nowIndex值为当前点击元素的下标
            nowIndex = this.index;
            //判断是否点击同一个小圆点，如果是的话直接退出函数
            if (nowIndex === lastIndex) return;

            //清除轮播
            clearInterval(timer);

            //清除li的class
            for (var j = 0; j < homeLiNodes.length; j++) {
              homeLiNodes[j].className = '';
            }

            //判断当前下标是否大于上一次的下标
            if (nowIndex > lastIndex) {
              //说明点击的是右边
              homeLiNodes[nowIndex].className = 'rightShow';
              homeLiNodes[lastIndex].className = 'leftHide';
            } else {
              //说明点击的是左边
              homeLiNodes[nowIndex].className = 'leftShow';
              homeLiNodes[lastIndex].className = 'rightHide';
            }

            common();
            //开启定时器
            autoPlay();
          }

        }

        function common() {
          //清除上一个小圆点的class
          homePointsNodes[lastIndex].className = '';
          //将当前点击的小圆点加上active
          homePointsNodes[nowIndex].className = 'active';

          //下标的同步
          lastIndex = nowIndex;
        }

        //自动轮播
        autoPlay();
        function autoPlay() {
          timer = setInterval(function () {
            //向右轮播
            nowIndex++;

            if (nowIndex > 3) {
              nowIndex = 0;
            }

            //点击右边
            homeLiNodes[nowIndex].className = 'rightShow';
            homeLiNodes[lastIndex].className = 'leftHide';

            common();

          }, 3000)
        }

      }

      //用户缩放浏览器事件
      window.onresize = function () {
        //修正小箭头的位置
        arrowNode.style.left = liNodes[nowIndex].getBoundingClientRect().left + liNodes[nowIndex].offsetWidth / 2
          - arrowNode.offsetWidth / 2 + 'px';
        //更新ul的位置
        ulNode.style.top = - nowIndex * contentNode.offsetHeight + 'px';
      }

      //头部js代码
      headerHandle();
      function headerHandle() {
        //初始化小箭头来到第一个up元素下面
        arrowNode.style.left = liNodes[0].getBoundingClientRect().left + liNodes[0].offsetWidth / 2
          - arrowNode.offsetWidth / 2 + 'px';
        //初始化时第一个up元素宽度为100%
        upNodes[0].style.width = '100%';
        //给每个li元素绑定点击事件
        for (var i = 0; i < liNodes.length; i++) {
          liNodes[i].index = i;
          liNodes[i].onclick = function () {
            //将nowIndex修改当前点击li元素的下标
            nowIndex = this.index;

            move(nowIndex);
          }
        }
      }

      /*
        函数节流：
          在一段时间内，用户会多次触发同一个函数，只让第一次生效，后面的无效
        函数防抖：
          在一段时间内，用户会多次触发同一个函数，只让最后一次生效，前面的无效
        意义：为了优化性能，少调用js函数
       */
      // move(4);
      function move(nowIndex) {
        //清除所有up的宽度 将宽度改为0
        for (var j = 0; j < upNodes.length; j++) {
          upNodes[j].style.width = '';
          menuBarPoints[j].className = '';
        }
        //将当前点击的元素的宽度改为100%
        upNodes[nowIndex].style.width = '100%';
        //改变小箭头的位置
        arrowNode.style.left = liNodes[nowIndex].getBoundingClientRect().left + liNodes[nowIndex].offsetWidth / 2
          - arrowNode.offsetWidth / 2 + 'px';
        //改变内容区ul的top值
        ulNode.style.top = - nowIndex * contentNode.offsetHeight + 'px';
        //改变侧边导航小圆点的class
        menuBarPoints[nowIndex].className = 'active';
        //将当前nowIndex对应屏做入场动画
        animationArr[nowIndex].anIn();
        //将上一次的index做出场动画
        animationArr[lastIndex].anOut();
        //同步下标
        lastIndex = nowIndex;
      }

      //滚轮事件
      //ie/chrome
      document.onmousewheel = wheel;
      //firefox
      if (document.addEventListener) {
        document.addEventListener('DOMMouseScroll', wheel);
      }

      function wheel(event) {
        //函数防抖
        //一上来清除延时定时器
        clearTimeout(wheelTimer);
        //设置了延时定期器来推迟函数的调用
        wheelTimer = setTimeout(function () {
          //判断用户向上滑还是向下滑
          var flag = null;
          if (event.wheelDelta) {
            if (event.wheelDelta > 0) {
              //向上滑
              flag = 'up';
            } else {
              //向下滑
              flag = 'down';
            }
          } else if (event.detail) {
            if (event.detail < 0) {
              //向上滑
              flag = 'up';
            } else {
              //向下滑
              flag = 'down';
            }
          }

          switch (flag) {
            case 'up' :
              if (nowIndex > 0) {
                nowIndex--;
                move(nowIndex);
              }
              break;
            case 'down' :
              if (nowIndex < liNodes.length - 1) {
                nowIndex++;
                move(nowIndex);
              }
              break;
          }
        }, 200);

      }

    }
  </script>
</body>
</html>
